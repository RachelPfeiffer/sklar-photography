(function($,window,document){'use strict';var showError=function(errorMessage,selector){var $container=$('.woocommerce-notices-wrapper, form.checkout');if(!$container||!$container.length){$(selector).prepend(errorMessage);return}else{$container=$container.first()}
$('.woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message').remove();$container.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+errorMessage+'</div>');$container.find('.input-text, select, input:checkbox').trigger('validate').blur();var scrollElement=$('.woocommerce-NoticeGroup-checkout');if(!scrollElement.length){scrollElement=$container}
if($.scroll_to_notices){$.scroll_to_notices(scrollElement)}else{$('html, body').animate({scrollTop:($container.offset().top-100)},1000)}
$(document.body).trigger('checkout_error')}
var getFundingMethods=function(methods){if(!methods){return undefined}
var paypal_funding_methods=[];for(var i=0;i<methods.length;i++){var method=paypal.FUNDING[methods[i]];if(method){paypal_funding_methods.push(method)}}
return paypal_funding_methods}
var render=function(isMiniCart){var prefix=isMiniCart?'mini_cart_':'';var button_size=wc_ppec_context[prefix+'button_size'];var button_layout=wc_ppec_context[prefix+'button_layout'];var button_label=wc_ppec_context[prefix+'button_label'];var allowed=wc_ppec_context[prefix+'allowed_methods'];var disallowed=wc_ppec_context[prefix+'disallowed_methods'];var selector=isMiniCart?'#woo_pp_ec_button_mini_cart':'#woo_pp_ec_button_'+wc_ppec_context.page;paypal.Button.render({env:wc_ppec_context.environment,locale:wc_ppec_context.locale,commit:'checkout'===wc_ppec_context.page&&!isMiniCart,funding:{allowed:getFundingMethods(allowed),disallowed:getFundingMethods(disallowed),},style:{color:wc_ppec_context.button_color,shape:wc_ppec_context.button_shape,layout:button_layout,size:button_size,label:button_label,branding:!0,tagline:!1,},validate:function(actions){$('#woo_pp_ec_button_product').off('.legacy').on('enable',actions.enable).on('disable',actions.disable)},payment:function(){$('.woocommerce-error',selector).remove();return new paypal.Promise(function(resolve,reject){if('product'===wc_ppec_context.page&&!isMiniCart){window.wc_ppec_generate_cart(resolve)}else{resolve()}}).then(function(){var data=$(selector).closest('form').add($('<input type="hidden" name="nonce" /> ').attr('value',wc_ppec_context.start_checkout_nonce)).add($('<input type="hidden" name="from_checkout" /> ').attr('value','checkout'===wc_ppec_context.page&&!isMiniCart?'yes':'no')).serialize();return paypal.request({method:'post',url:wc_ppec_context.start_checkout_url,body:data,}).then(function(response){if(!response.success){var messageItems=response.data.messages.map(function(message){return'<li>'+message+'</li>'}).join('');showError('<ul class="woocommerce-error" role="alert">'+messageItems+'</ul>',selector);return null}
return response.data.token})})},onAuthorize:function(data,actions){if('checkout'===wc_ppec_context.page&&!isMiniCart){$('form.checkout').append($('<input type="hidden" name="paymentToken" /> ').attr('value',data.paymentToken)).append($('<input type="hidden" name="payerID" /> ').attr('value',data.payerID)).submit()}else{return actions.redirect()}},},selector)};if(wc_ppec_context.page){render();$(document.body).on('updated_cart_totals updated_checkout',render.bind(this,!1))}
$(document.body).on('wc_fragments_loaded wc_fragments_refreshed',function(){var $button=$('.widget_shopping_cart #woo_pp_ec_button_mini_cart');if($button.length){$button.empty();render(!0)}})})(jQuery,window,document);
